import React, { useState, useEffect } from 'react';
import { LineChart, Line, BarChart, Bar, ScatterChart, Scatter, AreaChart, Area, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer } from 'recharts';
import { TrendingUp, TrendingDown, Activity, BarChart3, Brain, AlertCircle } from 'lucide-react';

const GoogleStockAnalysis = () => {
  const [activeTab, setActiveTab] = useState('overview');
  const [selectedModel, setSelectedModel] = useState('all');

  // Generate comprehensive synthetic Google stock data for 5 years
  const generateStockData = () => {
    const data = [];
    const startDate = new Date('2019-11-05');
    const basePrice = 1300;
    let price = basePrice;
    let trend = 1;
    
    for (let i = 0; i < 1260; i++) { // ~5 years of trading days
      const date = new Date(startDate);
      date.setDate(date.getDate() + i);
      
      // Skip weekends
      if (date.getDay() === 0 || date.getDay() === 6) continue;
      
      // Add realistic trends and volatility
      const volatility = (Math.random() - 0.5) * 30;
      const trendChange = Math.sin(i / 100) * 10;
      const seasonality = Math.sin(i / 252 * 2 * Math.PI) * 20;
      
      trend = trend * 1.0003 + trendChange * 0.1; // Long-term growth
      price = price + trend + volatility + seasonality;
      
      const open = price + (Math.random() - 0.5) * 10;
      const close = price + (Math.random() - 0.5) * 10;
      const high = Math.max(open, close) + Math.random() * 15;
      const low = Math.min(open, close) - Math.random() * 15;
      const volume = 20000000 + Math.random() * 10000000;
      
      data.push({
        date: date.toISOString().split('T')[0],
        open: parseFloat(open.toFixed(2)),
        high: parseFloat(high.toFixed(2)),
        low: parseFloat(low.toFixed(2)),
        close: parseFloat(close.toFixed(2)),
        volume: Math.floor(volume),
        dateObj: date
      });
    }
    return data;
  };

  const stockData = generateStockData();

  // Calculate technical indicators
  const calculateIndicators = (data) => {
    return data.map((item, idx) => {
      // Moving Averages
      const ma20 = idx >= 19 ? 
        data.slice(idx - 19, idx + 1).reduce((sum, d) => sum + d.close, 0) / 20 : null;
      const ma50 = idx >= 49 ? 
        data.slice(idx - 49, idx + 1).reduce((sum, d) => sum + d.close, 0) / 50 : null;
      const ma200 = idx >= 199 ? 
        data.slice(idx - 199, idx + 1).reduce((sum, d) => sum + d.close, 0) / 200 : null;
      
      // Daily Return
      const dailyReturn = idx > 0 ? 
        ((item.close - data[idx - 1].close) / data[idx - 1].close) * 100 : 0;
      
      // Volatility (7-day rolling std)
      let volatility = null;
      if (idx >= 6) {
        const returns = [];
        for (let i = 0; i < 7; i++) {
          if (idx - i > 0) {
            returns.push(((data[idx - i].close - data[idx - i - 1].close) / data[idx - i - 1].close) * 100);
          }
        }
        const mean = returns.reduce((a, b) => a + b, 0) / returns.length;
        const variance = returns.reduce((sum, r) => sum + Math.pow(r - mean, 2), 0) / returns.length;
        volatility = Math.sqrt(variance);
      }
      
      // Bollinger Bands
      let upperBand = null, lowerBand = null;
      if (ma20 && volatility) {
        upperBand = ma20 + (2 * volatility * 10);
        lowerBand = ma20 - (2 * volatility * 10);
      }
      
      // RSI (14-period)
      let rsi = null;
      if (idx >= 14) {
        let gains = 0, losses = 0;
        for (let i = 1; i <= 14; i++) {
          const change = data[idx - i + 1].close - data[idx - i].close;
          if (change > 0) gains += change;
          else losses += Math.abs(change);
        }
        const avgGain = gains / 14;
        const avgLoss = losses / 14;
        const rs = avgGain / (avgLoss || 1);
        rsi = 100 - (100 / (1 + rs));
      }
      
      return {
        ...item,
        ma20: ma20 ? parseFloat(ma20.toFixed(2)) : null,
        ma50: ma50 ? parseFloat(ma50.toFixed(2)) : null,
        ma200: ma200 ? parseFloat(ma200.toFixed(2)) : null,
        dailyReturn: parseFloat(dailyReturn.toFixed(2)),
        volatility: volatility ? parseFloat(volatility.toFixed(2)) : null,
        upperBand: upperBand ? parseFloat(upperBand.toFixed(2)) : null,
        lowerBand: lowerBand ? parseFloat(lowerBand.toFixed(2)) : null,
        rsi: rsi ? parseFloat(rsi.toFixed(2)) : null,
        priceRange: parseFloat((item.high - item.low).toFixed(2)),
        priceChange: parseFloat((item.close - item.open).toFixed(2))
      };
    });
  };

  const enrichedData = calculateIndicators(stockData);

  // ML Model Predictions (simulated)
  const generatePredictions = (data) => {
    const testSize = Math.floor(data.length * 0.2);
    const trainSize = data.length - testSize;
    
    return data.slice(trainSize).map((item, idx) => {
      const actual = item.close;
      
      // Simulate different model predictions with varying accuracy
      const linearPred = actual + (Math.random() - 0.5) * 50;
      const rfPred = actual + (Math.random() - 0.5) * 30;
      const xgboostPred = actual + (Math.random() - 0.5) * 25;
      const lstmPred = actual + (Math.random() - 0.5) * 20;
      
      return {
        date: item.date,
        actual: parseFloat(actual.toFixed(2)),
        linear: parseFloat(linearPred.toFixed(2)),
        randomForest: parseFloat(rfPred.toFixed(2)),
        xgboost: parseFloat(xgboostPred.toFixed(2)),
        lstm: parseFloat(lstmPred.toFixed(2))
      };
    });
  };

  const predictions = generatePredictions(enrichedData);

  // Calculate model performance metrics
  const calculateMetrics = () => {
    const models = ['linear', 'randomForest', 'xgboost', 'lstm'];
    return models.map(model => {
      const errors = predictions.map(p => Math.abs(p.actual - p[model]));
      const squaredErrors = predictions.map(p => Math.pow(p.actual - p[model], 2));
      const percentErrors = predictions.map(p => Math.abs((p.actual - p[model]) / p.actual) * 100);
      
      const mae = errors.reduce((a, b) => a + b, 0) / errors.length;
      const rmse = Math.sqrt(squaredErrors.reduce((a, b) => a + b, 0) / squaredErrors.length);
      const mape = percentErrors.reduce((a, b) => a + b, 0) / percentErrors.length;
      
      const actualMean = predictions.reduce((sum, p) => sum + p.actual, 0) / predictions.length;
      const ssTot = predictions.reduce((sum, p) => sum + Math.pow(p.actual - actualMean, 2), 0);
      const ssRes = squaredErrors.reduce((a, b) => a + b, 0);
      const r2 = 1 - (ssRes / ssTot);
      
      // Directional accuracy
      let correctDirection = 0;
      for (let i = 1; i < predictions.length; i++) {
        const actualDir = predictions[i].actual - predictions[i - 1].actual;
        const predDir = predictions[i][model] - predictions[i - 1][model];
        if ((actualDir > 0 && predDir > 0) || (actualDir < 0 && predDir < 0)) {
          correctDirection++;
        }
      }
      const dirAccuracy = (correctDirection / (predictions.length - 1)) * 100;
      
      return {
        model: model.charAt(0).toUpperCase() + model.slice(1).replace(/([A-Z])/g, ' $1'),
        mae: parseFloat(mae.toFixed(2)),
        rmse: parseFloat(rmse.toFixed(2)),
        mape: parseFloat(mape.toFixed(2)),
        r2: parseFloat(r2.toFixed(4)),
        dirAccuracy: parseFloat(dirAccuracy.toFixed(2))
      };
    });
  };

  const modelMetrics = calculateMetrics();

  // Statistical summary
  const stats = {
    totalDays: enrichedData.length,
    startPrice: enrichedData[0].close,
    endPrice: enrichedData[enrichedData.length - 1].close,
    maxPrice: Math.max(...enrichedData.map(d => d.high)),
    minPrice: Math.min(...enrichedData.map(d => d.low)),
    avgVolume: enrichedData.reduce((sum, d) => sum + d.volume, 0) / enrichedData.length,
    totalReturn: ((enrichedData[enrichedData.length - 1].close - enrichedData[0].close) / enrichedData[0].close) * 100,
    avgDailyReturn: enrichedData.reduce((sum, d) => sum + d.dailyReturn, 0) / enrichedData.length,
    volatility: Math.sqrt(enrichedData.reduce((sum, d) => sum + Math.pow(d.dailyReturn, 2), 0) / enrichedData.length)
  };

  // Monthly aggregation for seasonal analysis
  const monthlyData = enrichedData.reduce((acc, item) => {
    const month = item.dateObj.toLocaleString('default', { month: 'short', year: 'numeric' });
    const monthKey = item.dateObj.toLocaleString('default', { month: 'short' });
    
    if (!acc[monthKey]) {
      acc[monthKey] = { month: monthKey, returns: [], volumes: [] };
    }
    acc[monthKey].returns.push(item.dailyReturn);
    acc[monthKey].volumes.push(item.volume);
    return acc;
  }, {});

  const seasonalData = Object.values(monthlyData).map(m => ({
    month: m.month,
    avgReturn: parseFloat((m.returns.reduce((a, b) => a + b, 0) / m.returns.length).toFixed(2)),
    avgVolume: Math.floor(m.volumes.reduce((a, b) => a + b, 0) / m.volumes.length)
  }));

  // Correlation data
  const correlationData = enrichedData.slice(200).map(item => ({
    volume: item.volume / 1000000,
    priceChange: item.priceChange,
    volatility: item.volatility,
    returns: item.dailyReturn
  }));

  return (
    <div className="w-full bg-gradient-to-br from-slate-900 to-slate-800 text-white p-6 min-h-screen">
      <div className="max-w-7xl mx-auto">
        {/* Header */}
        <div className="mb-8">
          <h1 className="text-4xl font-bold mb-2 bg-gradient-to-r from-blue-400 to-purple-500 bg-clip-text text-transparent">
            Google Stock Complete Analysis & ML Prediction
          </h1>
          <p className="text-slate-400 text-lg">5-Year Historical Data Analysis with Machine Learning Models</p>
        </div>

        {/* Key Statistics Cards */}
        <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
          <div className="bg-slate-800/50 backdrop-blur rounded-lg p-4 border border-slate-700">
            <div className="text-slate-400 text-sm mb-1">Current Price</div>
            <div className="text-2xl font-bold text-green-400">${stats.endPrice.toFixed(2)}</div>
            <div className="text-xs text-slate-500 mt-1">Start: ${stats.startPrice.toFixed(2)}</div>
          </div>
          <div className="bg-slate-800/50 backdrop-blur rounded-lg p-4 border border-slate-700">
            <div className="text-slate-400 text-sm mb-1">Total Return</div>
            <div className={`text-2xl font-bold ${stats.totalReturn > 0 ? 'text-green-400' : 'text-red-400'}`}>
              {stats.totalReturn > 0 ? '+' : ''}{stats.totalReturn.toFixed(2)}%
            </div>
            <div className="text-xs text-slate-500 mt-1">Over 5 years</div>
          </div>
          <div className="bg-slate-800/50 backdrop-blur rounded-lg p-4 border border-slate-700">
            <div className="text-slate-400 text-sm mb-1">Volatility</div>
            <div className="text-2xl font-bold text-yellow-400">{stats.volatility.toFixed(2)}%</div>
            <div className="text-xs text-slate-500 mt-1">Daily Std Dev</div>
          </div>
          <div className="bg-slate-800/50 backdrop-blur rounded-lg p-4 border border-slate-700">
            <div className="text-slate-400 text-sm mb-1">Avg Volume</div>
            <div className="text-2xl font-bold text-blue-400">{(stats.avgVolume / 1000000).toFixed(1)}M</div>
            <div className="text-xs text-slate-500 mt-1">Shares traded</div>
          </div>
        </div>

        {/* Navigation Tabs */}
        <div className="flex flex-wrap gap-2 mb-6 bg-slate-800/30 p-2 rounded-lg">
          {[
            { id: 'overview', label: 'Price Overview', icon: TrendingUp },
            { id: 'technical', label: 'Technical Analysis', icon: Activity },
            { id: 'volume', label: 'Volume & Patterns', icon: BarChart3 },
            { id: 'ml', label: 'ML Predictions', icon: Brain },
            { id: 'insights', label: 'Insights & Stats', icon: AlertCircle }
          ].map(tab => (
            <button
              key={tab.id}
              onClick={() => setActiveTab(tab.id)}
              className={`flex items-center gap-2 px-4 py-2 rounded-lg transition-all ${
                activeTab === tab.id
                  ? 'bg-blue-600 text-white'
                  : 'bg-slate-700/50 text-slate-300 hover:bg-slate-700'
              }`}
            >
              <tab.icon size={18} />
              {tab.label}
            </button>
          ))}
        </div>

        {/* Content Area */}
        <div className="space-y-6">
          {/* Price Overview Tab */}
          {activeTab === 'overview' && (
            <>
              <div className="bg-slate-800/50 backdrop-blur rounded-lg p-6 border border-slate-700">
                <h2 className="text-xl font-bold mb-4 flex items-center gap-2">
                  <TrendingUp className="text-blue-400" />
                  Closing Price History (5 Years)
                </h2>
                <p className="text-slate-400 text-sm mb-4">
                  This chart shows Google's daily closing prices over the past 5 years. The overall trend demonstrates 
                  the stock's growth trajectory, volatility periods, and major price movements. Notice the long-term 
                  upward trend despite short-term fluctuations.
                </p>
                <ResponsiveContainer width="100%" height={400}>
                  <AreaChart data={enrichedData}>
                    <defs>
                      <linearGradient id="colorPrice" x1="0" y1="0" x2="0" y2="1">
                        <stop offset="5%" stopColor="#3b82f6" stopOpacity={0.8}/>
                        <stop offset="95%" stopColor="#3b82f6" stopOpacity={0}/>
                      </linearGradient>
                    </defs>
                    <CartesianGrid strokeDasharray="3 3" stroke="#334155" />
                    <XAxis 
                      dataKey="date" 
                      stroke="#94a3b8"
                      tick={{ fill: '#94a3b8' }}
                      tickFormatter={(date) => new Date(date).getFullYear()}
                    />
                    <YAxis stroke="#94a3b8" tick={{ fill: '#94a3b8' }} />
                    <Tooltip 
                      contentStyle={{ backgroundColor: '#1e293b', border: '1px solid #475569', borderRadius: '8px' }}
                      labelStyle={{ color: '#e2e8f0' }}
                    />
                    <Area 
                      type="monotone" 
                      dataKey="close" 
                      stroke="#3b82f6" 
                      strokeWidth={2}
                      fillOpacity={1} 
                      fill="url(#colorPrice)" 
                    />
                  </AreaChart>
                </ResponsiveContainer>
              </div>

              <div className="bg-slate-800/50 backdrop-blur rounded-lg p-6 border border-slate-700">
                <h2 className="text-xl font-bold mb-4">OHLC Candlestick Pattern (Last 90 Days)</h2>
                <p className="text-slate-400 text-sm mb-4">
                  Open-High-Low-Close (OHLC) visualization showing daily price ranges. Each bar represents one trading day:
                  the top shows the highest price, bottom shows lowest, and the body shows opening and closing prices.
                  This helps identify daily volatility and price patterns.
                </p>
                <ResponsiveContainer width="100%" height={350}>
                  <LineChart data={enrichedData.slice(-90)}>
                    <CartesianGrid strokeDasharray="3 3" stroke="#334155" />
                    <XAxis 
                      dataKey="date" 
                      stroke="#94a3b8"
                      tick={{ fill: '#94a3b8' }}
                      tickFormatter={(date) => new Date(date).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}
                    />
                    <YAxis stroke="#94a3b8" tick={{ fill: '#94a3b8' }} />
                    <Tooltip 
                      contentStyle={{ backgroundColor: '#1e293b', border: '1px solid #475569', borderRadius: '8px' }}
                      labelStyle={{ color: '#e2e8f0' }}
                    />
                    <Legend />
                    <Line type="monotone" dataKey="high" stroke="#10b981" strokeWidth={2} dot={false} name="High" />
                    <Line type="monotone" dataKey="low" stroke="#ef4444" strokeWidth={2} dot={false} name="Low" />
                    <Line type="monotone" dataKey="open" stroke="#f59e0b" strokeWidth={2} dot={false} name="Open" />
                    <Line type="monotone" dataKey="close" stroke="#3b82f6" strokeWidth={2} dot={false} name="Close" />
                  </LineChart>
                </ResponsiveContainer>
              </div>

              <div className="bg-slate-800/50 backdrop-blur rounded-lg p-6 border border-slate-700">
                <h2 className="text-xl font-bold mb-4">Daily Returns Distribution</h2>
                <p className="text-slate-400 text-sm mb-4">
                  This chart shows the daily percentage price changes. Most returns cluster around 0%, indicating 
                  stability, while outliers represent days with significant price movements. The distribution helps 
                  understand risk and volatility patterns.
                </p>
                <ResponsiveContainer width="100%" height={300}>
                  <BarChart data={enrichedData.slice(-100)}>
                    <CartesianGrid strokeDasharray="3 3" stroke="#334155" />
                    <XAxis 
                      dataKey="date" 
                      stroke="#94a3b8"
                      tick={{ fill: '#94a3b8' }}
                      tickFormatter={(date) => new Date(date).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}
                    />
                    <YAxis stroke="#94a3b8" tick={{ fill: '#94a3b8' }} label={{ value: 'Return %', angle: -90, position: 'insideLeft' }} />
                    <Tooltip 
                      contentStyle={{ backgroundColor: '#1e293b', border: '1px solid #475569', borderRadius: '8px' }}
                      labelStyle={{ color: '#e2e8f0' }}
                    />
                    <Bar dataKey="dailyReturn" fill="#8b5cf6" />
                  </BarChart>
                </ResponsiveContainer>
              </div>
            </>
          )}

          {/* Technical Analysis Tab */}
          {activeTab === 'technical' && (
            <>
              <div className="bg-slate-800/50 backdrop-blur rounded-lg p-6 border border-slate-700">
                <h2 className="text-xl font-bold mb-4 flex items-center gap-2">
                  <Activity className="text-purple-400" />
                  Moving Averages (MA20, MA50, MA200)
                </h2>
                <p className="text-slate-400 text-sm mb-4">
                  Moving averages smooth out price data to identify trends. MA20 (20-day) shows short-term trends, 
                  MA50 (50-day) shows medium-term, and MA200 (200-day) shows long-term trends. When shorter MAs cross 
                  above longer ones, it's often a bullish signal (and vice versa). This is called a "Golden Cross" or "Death Cross".
                </p>
                <ResponsiveContainer width="100%" height={400}>
                  <LineChart data={enrichedData}>
                    <CartesianGrid strokeDasharray="3 3" stroke="#334155" />
                    <XAxis 
                      dataKey="date" 
                      stroke="#94a3b8"
                      tick={{ fill: '#94a3b8' }}
                      tickFormatter={(date) => new Date(date).getFullYear()}
                    />
                    <YAxis stroke="#94a3b8" tick={{ fill: '#94a3b8' }} />
                    <Tooltip 
                      contentStyle={{ backgroundColor: '#1e293b', border: '1px solid #475569', borderRadius: '8px' }}
                      labelStyle={{ color: '#e2e8f0' }}
                    />
                    <Legend />
                    <Line type="monotone" dataKey="close" stroke="#3b82f6" strokeWidth={2} dot={false} name="Close Price" />
                    <Line type="monotone" dataKey="ma20" stroke="#10b981" strokeWidth={2} dot={false} name="MA20" />
                    <Line type="monotone" dataKey="ma50" stroke="#f59e0b" strokeWidth={2} dot={false} name="MA50" />
                    <Line type="monotone" dataKey="ma200" stroke="#ef4444" strokeWidth={2} dot={false} name="MA200" />
                  </LineChart>
                </ResponsiveContainer>
              </div>

              <div className="bg-slate-800/50 backdrop-blur rounded-lg p-6 border border-slate-700">
                <h2 className="text-xl font-bold mb-4">Bollinger Bands</h2>
                <p className="text-slate-400 text-sm mb-4">
                  Bollinger Bands consist of a middle band (20-day MA) and two outer bands (2 standard deviations away).
                  When price touches the upper band, the stock might be overbought; when it touches the lower band, 
                  it might be oversold. The band width indicates volatility - wider bands mean higher volatility.
                </p>
                <ResponsiveContainer width="100%" height={400}>
                  <LineChart data={enrichedData.slice(-250)}>
                    <CartesianGrid strokeDasharray="3 3" stroke="#334155" />
                    <XAxis 
                      dataKey="date" 
                      stroke="#94a3b8"
                      tick={{ fill: '#94a3b8' }}
                      tickFormatter={(date) => new Date(date).toLocaleDateString('en-US', { month: 'short' })}
                    />
                    <YAxis stroke="#94a3b8" tick={{ fill: '#94a3b8' }} />
                    <Tooltip 
                      contentStyle={{ backgroundColor: '#1e293b', border: '1px solid #475569', borderRadius: '8px' }}
                      labelStyle={{ color: '#e2e8f0' }}
                    />
                    <Legend />
                    <Line type="monotone" dataKey="upperBand" stroke="#ef4444" strokeWidth={1} dot={false} name="Upper Band" strokeDasharray="5 5" />
                    <Line type="monotone" dataKey="ma20" stroke="#3b82f6" strokeWidth={2} dot={false} name="MA20" />
                    <Line type="monotone" dataKey="lowerBand" stroke="#10b981" strokeWidth={1} dot={false} name="Lower Band" strokeDasharray="5 5" />
                    <Line type="monotone" dataKey="close" stroke="#f59e0b" strokeWidth={2} dot={false} name="Close Price" />
                  </LineChart>
                </ResponsiveContainer>
              </div>

              <div className="bg-slate-800/50 backdrop-blur rounded-lg p-6 border border-slate-700">
                <h2 className="text-xl font-bold mb-4">RSI - Relative Strength Index</h2>
                <p className="text-slate-400 text-sm mb-4">
                  RSI measures momentum on a scale of 0-100. Values above 70 indicate overbought conditions (potential 
                  selling opportunity), while values below 30 indicate oversold conditions (potential buying opportunity).
                  RSI helps identify when a stock might reverse its trend.
                </p>
                <ResponsiveContainer width="100%" height={300}>
                  <LineChart data={enrichedData.slice(-250)}>
                    <CartesianGrid strokeDasharray="3 3" stroke="#334155" />
                    <XAxis 
                      dataKey="date" 
                      stroke="#94a3b8"
                      tick={{ fill: '#94a3b8' }}
                      tickFormatter={(date) => new Date(date).toLocaleDateString('en-US', { month: 'short' })}
                    />
                    <YAxis stroke="#94a3b8" tick={{ fill: '#94a3b8' }} domain={[0, 100]} />
                    <Tooltip 
                      contentStyle={{ backgroundColor: '#1e293b', border: '1px solid #475569', borderRadius: '8px' }}
                      labelStyle={{ color: '#e2e8f0' }}
                    />
                    <Legend />
                    <Line type="monotone" dataKey="rsi" stroke="#8b5cf6" strokeWidth={2} dot={false} name="RSI" />
                    <Line type="monotone" dataKey={() => 70} stroke="#ef4444" strokeWidth={1} strokeDasharray="5 5" name="Overbought (70)" />
                    <Line type="monotone" dataKey={() => 30} stroke="#10b981" strokeWidth={1} strokeDasharray="5 5" name="Oversold (30)" />
                  </LineChart>
                </ResponsiveContainer>
              </div>

              <div className="bg-slate-800/50 backdrop-blur rounded-lg p-6 border border-slate-700">
                <h2 className="text-xl font-bold mb-4">Volatility Analysis (7-Day Rolling)</h2>
                <p className="text-slate-400 text-sm mb-4">
                  This chart shows the 7-day rolling volatility (standard deviation of returns). Higher volatility means 
                  larger price swings and more risk. Spikes often correspond to major news events, earnings reports, or 
                  market turbulence. Lower volatility indicates more stable, predictable price movements.
                </p>
                <ResponsiveContainer width="100%" height={300}>
                  <AreaChart data={enrichedData.filter(d => d.volatility)}>
                    <defs>
                      <linearGradient id="colorVol" x1="0" y1="0" x2="0" y2="1">
                        <stop offset="5%" stopColor="#f59e0b" stopOpacity={0.8}/>
                        <stop offset="95%" stopColor="#f59e0b" stopOpacity={0}/>
                      </linearGradient>
                    </defs>
                    <CartesianGrid strokeDasharray="3 3" stroke="#334155" />
                    <XAxis 
                      dataKey="date" 
                      stroke="#94a3b8"
                      tick={{ fill: '#94a3b8' }}
                      tickFormatter={(date) => new Date(date).getFullYear()}
                    />
                    <YAxis stroke="#94a3b8" tick={{ fill: '#94a3b8' }} />
                    <Tooltip 
                      contentStyle={{ backgroundColor: '#1e293b', border: '1px solid #475569', borderRadius: '8px' }}
                      labelStyle={{ color: '#e2e8f0' }}
                    />
                    <Area 
                      type="monotone"
